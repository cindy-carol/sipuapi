<h1 class="mb-4">Daftar Mahasiswa</h1>

<div class=" d-flex align-items-center justify-content-between flex-wrap gap-3">
  <!-- Grup kiri -->
<%- include('../partials/tahun-ajaran', { targetUrl: '/kaprodi/daftar-mahasiswa' }) %>
</div>

<!-- Tabel Mahasiswa -->
<div class="table-responsive">
  <table class="table table-bordered text-center align-middle">
    <thead class="table-light">
      <tr>
        <th scope="col" style="width:1%">No.</th>
        <th scope="col" style="width: 10%;">NPM</th>
        <th scope="col" style="width: 20%;">Nama Mahasiswa</th>
        <th scope="col" style="width: 15%">Tahun Ajaran</th>
      </tr>
    </thead>
    <tbody>
      <% if (mahasiswa && mahasiswa.length > 0) { %>
        <% mahasiswa.forEach((mhs, index) => { %>
          <tr>
            <th scope="row"><%= index + 1 %></th>
            <td class="editable" data-field="npm"><%= mhs.npm %></td>
            <td class="editable text-start" data-field="nama"><%= mhs.nama %></td>
            <td class="editable" data-field="tahun">
              <%= mhs.nama_tahun + ' ' + mhs.semester %>
            </td>
          </tr>
        <% }) %>
      <% } else { %>
        <tr>
          <td colspan="5" class="text-muted py-4">Tidak ada data mahasiswa</td>
        </tr>
      <% } %>
    </tbody>
  </table>
</div>

<script>
document.getElementById("tahun_ajaran").addEventListener("change", function() {
  const filterValue = this.value;
  const baseUrl = window.location.pathname;
  const url = filterValue 
    ? `${baseUrl}?tahun_ajaran=${encodeURIComponent(filterValue)}`
    : baseUrl;

  window.location.href = url;
});
</script>

<style>
@font-face {
    font-family: 'Times New Roman Custom';
    src: url("data:font/ttf;charset=utf-8;base64,<%= fontTMR %>") format("truetype");
    font-weight: normal;
    font-style: normal;
}

/* Reset Dasar */
body {
    font-family: 'Times New Roman Custom', serif;
    font-size: 12pt;
    line-height: 1.2; /* Dikecilkan sedikit agar tidak meluber */
    margin: 0;
    padding: 0;
}

.surat-wrapper {
    width: 100%;
    /* Gunakan font kustom secara global di wrapper */
    font-family: 'Times New Roman Custom', serif; 
}

/* Bagian Kop Surat */
.kop {
    text-align: center;
    /* Jangan gunakan scaleX atau transform jika font sudah benar, ini bikin teks pecah */
    transform: none; 
}

.kop strong {
    display: block;
    font-weight: bold;
    font-size: 13pt; /* Sedikit diperbesar agar tegas */
    line-height: 1.1;
}

.kop h3 {
    font-family: 'Times New Roman Custom', serif;
    font-size: 16pt;
    font-weight: bold;
    margin: 2px 0;
    line-height: 1.1;
}

.kop .alamat {
    font-family: 'Times New Roman Custom', serif; /* Samakan font agar sinkron */
    font-size: 9pt;
    line-height: 1.2;
}

.kop-line {
    border-top: 3px double black; /* Ketebalan disesuaikan */
    margin-top: 5px;
    margin-bottom: 15px;
    width: 100%;
}

/* Tabel Informasi & Isi */
table {
    border-collapse: collapse;
    font-family: 'Times New Roman Custom', serif;
    font-size: 11pt;
    width: auto; /* Biarkan tabel mengikuti isi agar tidak hancur */
}

.baris-info, .informasi, .content, .signature, .catatan {
    /* Padding disesuaikan agar pas di kertas A4 */
    padding: 0 15mm 0 15mm; 
}

p {
    margin-bottom: 5px;
    text-align: justify;
    line-height: 1.4; /* Spasi antar baris di paragraf lebih lega agar enak dibaca */
}

.signature {
    margin-top: 40px;
    padding-right: 20mm; /* Geser tanda tangan agak ke tengah dari kanan */
}

.catatan {
    margin-top: 30px;
    font-size: 10pt;
}
</style>

<div class="surat-wrapper">
    <div style="display: flex; align-items: flex-start; gap: 15px;">
        <div style="flex-shrink: 0;">
            <img src="<%= logoPath %>" alt="Logo Kampus" style="width: 125px; height: auto;">
        </div>

        <div class="kop" style="flex-grow: 1;">
            <% if (typeof kopSurat !== 'undefined' && kopSurat) { %>
                <%- kopSurat.replace(/\n/g, '<br>') %>
            <% } else { %>
                KEMENTERIAN PENDIDIKAN TINGGI, SAINS, DAN TEKNOLOGI
                <strong>UNIVERSITAS LAMPUNG - FAKULTAS TEKNIK</strong>
                <h3>PROGRAM STUDI PROGRAM PROFESI INSINYUR</h3>
            <% } %>

            <div class="alamat">
                Gedung A Dekanat Fakultas Teknik <br>
                Jalan Prof. Dr. Soemantri Brojonegoro No. 1 Bandar Lampung 35145 <br>
                Telepon (0721) 704947 Fax. (0721) 704947 <br>
                Email: <a href="mailto:ppi@eng.unila.ac.id">ppi@eng.unila.ac.id</a>
            </div>
        </div>
    </div>

    <div class="kop-line"></div>

    <div class="baris-info" style="display: flex; justify-content: space-between; margin-bottom: 15px;">
        <table style="border: none;">
            <tr>
                <td style="width: 50px;">Nomor</td>
                <td>:</td>
                <td style="text-indent: 1.5em;">/UN26.15.17/PPI.00/2025</td>
            </tr>
            <tr>
                <td>Hal</td>
                <td>:</td>
                <td>Undangan Ujian Akhir Profesi</td>
            </tr>
        </table>

        <div style="flex-shrink: 0;">
            <%= tanggalSurat %>
        </div>
    </div>

    <div class="informasi">
      <div style="margin-top: 10px;">
          Yth.<br>
          <strong><%= pembimbing1 || '-' %></strong><br>
          <strong><%= pembimbing2 || '-' %></strong><br>
          <strong><%= penguji || '-' %></strong><br>
          <strong><%= namaMahasiswa %> (Mahasiswa)</strong><br>
          
          <div style="margin-top: 10px;">
              di
              <div style="text-indent: 1.5em;">
                  Tempat
              </div>
          </div>
      </div>

      <p style="margin-top: 20px;">
          Dengan hormat,
      </p>
    </div>

    <div class="content">
        <p style="text-align: justify;">
            <% if (typeof kalimatPembuka !== 'undefined' && kalimatPembuka) { %>
                <%- kalimatPembuka.replace(/\n/g, '<br>') %>
            <% } else { %>
                Sebagai salah satu syarat untuk menyelesaikan studi pada Program Studi Program Profesi Insinyur (PS-PPI) Universitas Lampung (Unila), maka kami mengundang Bapak/Ibu/Sdr pada:
            <% } %>
        </p>

        <table style="border: none; margin-top: 10px;">
            <tr>
                <td style="width: 130px;">Hari / Tanggal</td>
                <td style="width: 10px;">:</td>
                <td><%= tanggalUjian || '-' %></td>
            </tr>
            <tr>
                <td>Waktu</td>
                <td>:</td>
                <td><%= waktuUjian || '-' %> WIB </td>
            </tr>    
            <tr>
                <td>Tempat</td>
                <td>:</td>
                <td class="jadwal" style="vertical-align: top;">
                    <% if (tipeUjian === 'offline') { %>
                        <%= tempatUjian %>
                
                    <% } else if (tipeUjian === 'online') { %>
                        Zoom Meeting <br>
                
                        <% if (meetingID) { %>
                            ID Rapat : <%= meetingID %> <br>
                        <% } %>
                
                        <% if (passcode) { %>
                            Kode Sandi : <%= passcode %> <br>
                        <% } %>
                
                        <% if (linkZoom) { %>
                            <a href="<%= linkZoom %>" target="_blank" style="color: blue; text-decoration: underline; word-break: break-all;">
                                <%= linkZoom %>
                            </a>
                        <% } %>
                
                    <% } %>
                </td>
            </tr>
        </table>
        
        <br>
        <table style="border: none; ">
            <tr>
                <td style="width: 130px;">Pembimbing I</td>
                <td style="width: 10px;">:</td>
                <td><%= pembimbing1 || '-' %></td>
            </tr>    
            <tr>
                <td>Pembimbing II</td>
                <td style="width: 10px;">:</td>
                <td><%= pembimbing2 || '-' %></td>
            </tr>
            <tr>
                <td>Penguji</td>
                <td style="width: 10px;">:</td>
                <td><%= penguji || '-' %></td>
            </tr>    
        </table>
        
        <br>
        <% if (typeof isi !== 'undefined' && isi) { %>
            <%- isi.replace(/\n/g, '<br>') %>
            <% } else { %>
            Untuk melaksanakan Ujian Akhir Profesi Mahasiswa **):
            <% } %>
        <table style="border: none; ">
            <tr>
                <td style="width: 130px;">Nama</td>
                <td style="width: 10px;">:</td>
                <td><%= namaMahasiswa %></td>
            </tr>
            <tr>
                <td>NPM</td>
                <td style="width: 10px;">:</td>
                <td><%= npm %></td>
            </tr>
        </table>

        <p style="margin-top: 10px;">
            <% if (typeof kalimatPenutup !== 'undefined' && kalimatPenutup) { %>
                <%- kalimatPenutup.replace(/\n/g, '<br>') %>
            <% } else { %>
                Demikian atas perhatian dan kerjasama yang baik kami ucapkan terima kasih.
            <% } %>
        </p>
    </div>

    <div class="signature">
        <div class="signature-content">
            Ketua,<br>
            <br><br><br>
            <%= kaprodi?.nama || '-' %><br>
            NIP <%= kaprodi?.nip_dosen || '-' %>
        </div>
    </div>

    <div class="catatan" style="font-family: 'Times New Roman', serif; font-size: 11pt; white-space: pre-line;">
        <div style="font-weight: bold;">Catatan:</div>
        <%- catatanKaki %>
    </div>
</div>



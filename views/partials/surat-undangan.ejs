<style>
    /* 1. Definisikan Font */
    @font-face {
        font-family: 'Times New Roman Custom';
        src: url("https://pqhvckeycgcqlnjcjqvp.supabase.co/storage/v1/object/public/storage_sipuapi/times.ttf") format("truetype");
        font-weight: normal;
        font-style: normal;
    }
    @font-face {
        font-family: 'Cambria Custom';
        src: url("https://pqhvckeycgcqlnjcjqvp.supabase.co/storage/v1/object/public/storage_sipuapi/cambria.ttf") format("truetype");
        font-weight: normal;
        font-style: normal;
    }

    /* 2. RESET MARGIN & JARAK (PENTING!) */
    /* Menghilangkan jarak antar baris dari tag <p> Summernote */
    .kop-render p, .content p {
        margin: 0 !important;
        padding: 0 !important;
        line-height: 1.1 !important; /* Paksa rapat */
    }

    .surat-wrapper {
        font-size: 11.5pt;
        font-family: "Times New Roman Custom", serif;
        line-height: 1.3;
    }

    /* 3. KOP STYLING (GEPENG & RAPAT) */
    .kop-render {
        text-align: center;
        flex-grow: 1;
        /* Efek Gepeng/Tarik (Condensed) */
        transform: scaleX(0.92); 
        transform-origin: center;
        letter-spacing: 0.2px;
    }

    /* Mengatur ketebalan khusus baris di dalam Kop */
    .kop-render strong, .kop-render h3, .kop-render b {
        font-weight: 900 !important; /* Paling Bold */
        display: block;
    }

    .alamat-default {
        font-family: "Cambria Custom", serif;
        font-size: 10pt;
        margin-top: 3px; /* Jarak dikit dari instansi */
        line-height: 1.2 !important;
    }

    .alamat-default a {
        color: #0000EE;
        text-decoration: underline;
    }

    .kop-line {
        border-top: 4px solid black; /* Garis tebal */
        border-bottom: 1px solid black; /* Garis tipis */
        height: 2px;
        margin: 8px 0 15px 0;
    }

    /* 4. LAYOUT & PADDING */
    .baris-info, .informasi, .content, .signature, .catatan {
        padding: 0 15mm 0 20mm;
    }

    .signature {
        margin-top: 30px;
        text-align: right;
    }
    .signature-content {
        display: inline-block;
        text-align: left;
    }

    .content table td {
        vertical-align: top;
    }

    p {
        margin-bottom: 0;
    }
</style>

<div class="surat-wrapper">
    <div style="display: flex; align-items: flex-start; gap: 10px;">
        <div style="flex-shrink: 0;">
            <img src="<%= logoPath %>" alt="Logo" style="width: 150px; height: auto;">
        </div>

        <div style="flex-grow: 1;">
            <div class="kop-render">
                <% if (typeof kopSurat !== 'undefined' && kopSurat) { %>
                    <%- kopSurat %> <% } else { %>
                    KEMENTERIAN PENDIDIKAN TINGGI, SAINS, DAN TEKNOLOGI<br>
                    <strong>UNIVERSITAS LAMPUNG - FAKULTAS TEKNIK</strong><br>
                    <h3 style="margin:0;">PROGRAM STUDI PROGRAM PROFESI INSINYUR</h3>
                <% } %>
            </div>

            <div class="alamat-default" style="text-align: center;">
                Gedung A Dekanat Fakultas Teknik <br>
                Jalan Prof. Dr. Soemantri Brojonegoro No. 1 Bandar Lampung 35145 <br>
                Telepon (0721) 704947 Fax. (0721) 704947 <br>
                Email: <a href="mailto:ppi@eng.unila.ac.id">ppi@eng.unila.ac.id</a>
            </div>
        </div>
    </div>

    <div class="kop-line"></div>

    <div class="baris-info" style="display: flex; justify-content: space-between; margin-bottom: 15px;">
        <table style="border: none;">
            <tr>
                <td style="width: 50px;">Nomor</td>
                <td>:</td>
                <td style="text-indent: 1.5em;">/UN26.15.17/PPI.00/2025</td>
            </tr>
            <tr>
                <td>Hal</td>
                <td>:</td>
                <td>Undangan Ujian Akhir Profesi</td>
            </tr>
        </table>

        <div style="flex-shrink: 0;">
            <%= tanggalSurat %>
        </div>
    </div>

    <div class="informasi">
      <div style="margin-top: 10px;">
          Yth.<br>
          <strong><%= pembimbing1 || '-' %></strong><br>
          <strong><%= pembimbing2 || '-' %></strong><br>
          <strong><%= penguji || '-' %></strong><br>
          <strong><%= namaMahasiswa %> (Mahasiswa)</strong><br>
          
          <div style="margin-top: 10px;">
              di
              <div style="text-indent: 1.5em;">
                  Tempat
              </div>
          </div>
      </div>

      <p style="margin-top: 20px;">
          Dengan hormat,
      </p>
    </div>

    <div class="content">
        <p style="text-align: justify;">
            <% if (typeof kalimatPembuka !== 'undefined' && kalimatPembuka) { %>
                <%- kalimatPembuka.replace(/\n/g, '<br>') %>
            <% } else { %>
                Sebagai salah satu syarat untuk menyelesaikan studi pada Program Studi Program Profesi Insinyur (PS-PPI) Universitas Lampung (Unila), maka kami mengundang Bapak/Ibu/Sdr pada:
            <% } %>
        </p>

        <table style="border: none; margin-top: 10px;">
            <tr>
                <td style="width: 130px;">Hari / Tanggal</td>
                <td style="width: 10px;">:</td>
                <td><%= tanggalUjian || '-' %></td>
            </tr>
            <tr>
                <td>Waktu</td>
                <td>:</td>
                <td><%= waktuUjian || '-' %> WIB </td>
            </tr>    
            <tr>
                <td>Tempat</td>
                <td>:</td>
                <td class="jadwal" style="vertical-align: top;">
                    <% if (tipeUjian === 'offline') { %>
                        <%= tempatUjian %>
                
                    <% } else if (tipeUjian === 'online') { %>
                        Zoom Meeting <br>
                
                        <% if (meetingID) { %>
                            ID Rapat : <%= meetingID %> <br>
                        <% } %>
                
                        <% if (passcode) { %>
                            Kode Sandi : <%= passcode %> <br>
                        <% } %>
                
                        <% if (linkZoom) { %>
                            <a href="<%= linkZoom %>" target="_blank" style="color: blue; text-decoration: underline; word-break: break-all;">
                                <%= linkZoom %>
                            </a>
                        <% } %>
                
                    <% } %>
                </td>
            </tr>
        </table>
        
        <br>
        <table style="border: none; ">
            <tr>
                <td style="width: 130px;">Pembimbing I</td>
                <td style="width: 10px;">:</td>
                <td><%= pembimbing1 || '-' %></td>
            </tr>    
            <tr>
                <td>Pembimbing II</td>
                <td style="width: 10px;">:</td>
                <td><%= pembimbing2 || '-' %></td>
            </tr>
            <tr>
                <td>Penguji</td>
                <td style="width: 10px;">:</td>
                <td><%= penguji || '-' %></td>
            </tr>    
        </table>
        
        <br>
        <% if (typeof isi !== 'undefined' && isi) { %>
            <%- isi.replace(/\n/g, '<br>') %>
            <% } else { %>
            Untuk melaksanakan Ujian Akhir Profesi Mahasiswa **):
            <% } %>
        <table style="border: none; ">
            <tr>
                <td style="width: 130px;">Nama</td>
                <td style="width: 10px;">:</td>
                <td><%= namaMahasiswa %></td>
            </tr>
            <tr>
                <td>NPM</td>
                <td style="width: 10px;">:</td>
                <td><%= npm %></td>
            </tr>
        </table>

        <p style="margin-top: 10px;">
            <% if (typeof kalimatPenutup !== 'undefined' && kalimatPenutup) { %>
                <%- kalimatPenutup.replace(/\n/g, '<br>') %>
            <% } else { %>
                Demikian atas perhatian dan kerjasama yang baik kami ucapkan terima kasih.
            <% } %>
        </p>
    </div>

    <div class="signature">
        <div class="signature-content">
            Ketua,<br>
            <br><br><br>
            <%= kaprodi?.nama || '-' %><br>
            NIP <%= kaprodi?.nip_dosen || '-' %>
        </div>
    </div>

    <div class="catatan" style="font-family: 'Times New Roman', serif; font-size: 11pt; white-space: pre-line;">
        <div style="font-weight: bold;">Catatan:</div>
        <%- catatanKaki %>
    </div>
</div>